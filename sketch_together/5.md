## Part II: The JS File Continued 

### Displaying the Points

Next, we'll want to display the points that we've requested from Firebase, by moving through the `points` array and drawing an ellipse at each point:

```js
function draw() {
  for (var i = 0; i < points.length; i++) {
    var point = points[i]
    ellipse(point.x, point.y, 5, 5)
  }
}
```

We'll also want to repaint the background at each `draw()` function call, so let's call `background()` before drawing the points:

```js
function draw() {
  background(255)

  for (var i = 0; i < points.length; i++) {
    var point = points[i]
    ellipse(point.x, point.y, 5, 5)
  }
}
```

### Drawing Points

Now let's add functionality to be able to click and draw, and have the points that we've drawn be updated in Firebase.

We'll first create a function after the draw function that takes the mouse x and y position and pushes that information to Firebase:

```js
function draw() {
  // ...the rest of the draw function
}

function drawPoint() {
  pointsData.push({ x: mouseX, y: mouseY })
}
```

[`mouseX`](https://p5js.org/reference/#p5/mouseX) and [`mouseY`](https://p5js.org/reference/#p5/mouseY) are provided by p5.js.

We don't even have to draw ellipses directly in these functions, because that'll be taken care of by the `.on()` handler that we have in `setup()`, which will get our newly created points from Firebase and add them to the `points` array, which will then be drawn by `draw()`.

Next, we'll set up our functions to detect clicking and dragging. Normally we would use `mousePressed()` and `mouseDragged()`, but we want to restrict the event handling to the canvas. We don't want to send mouse data to Firebase if the clicking isn't happening within the canvas.

So instead, we'll be detecting mouse activity with one of the canvas's methods. In order to call a method of canvas, we must store our canvas in a variable. Alter the `createCanvas()` line in `setup()`:

```diff
- createCanvas(400, 400);
+ var canvas = createCanvas(400, 400);
```

And then we can use the `.mousePressed()` method, and pass in our previously created `drawPoint()` function as an argument. This means that `drawPoint()` will be executed when there is a mouse pressed on the canvas.

Type the following at the end of the `setup()` function:

```js
function setup() {
  // ...the rest of the setup function
  pointsData.on('child_added', function(point) {
    points.push(point.val())
  })

  canvas.mousePressed(drawPoint)
}
```

We also want `drawPoint()` to be called when we drag our mouse, but there is no `.mouseDragged()` method. So we'll make our own, out of the `mouseIsPressed` p5.js property, and the canvas method `.mouseMoved()`. If `mouseIsPressed` is true during `.mouseMoved()`, that means our mouse is being dragged!

We can start by adding this beneath `canvas.mousePressed(drawPoint);`:

```js
function setup() {
  // ...the rest of the setup function
  canvas.mousePressed(drawPoint)
  canvas.mouseMoved(drawPoint)
}
```

That's not _quite_ right, because we want to execute `drawPoint()`, but only if `mouseIsPressed` is true.

We could write a separate function right under `drawPoint`:

```js
function drawPoint() {
  // ...the rest of the drawPoint function
}

function drawPointIfMousePressed() {
  if (mouseIsPressed) {
    drawPoint()
  }
}
```

And then use it:

```diff
- canvas.mouseMoved(drawPoint);
+ canvas.mouseMoved(drawPointIfMousePressed);
```

Now, if we save and refresh live preview (opened with `preview` > `live preview`), we'll be able to draw stuff. Then, if we link the URL of our external live preview to a friend, we'll be able to see what they're drawing as well! Awesome!

Now that something kinda works, let's make it official by committing and pushing! See if you remember the commands to use.

Once you have pushed, remember to add `USERNAME.github.io` to the list of Authorized Domains on your Firebase app. After that, your project should be live on `USERNAME.github.io/collaborative_sketch/`! To see how to add an authorized domain, go to [Setting up the Firebase App](#setting-up-the-firebase-app).